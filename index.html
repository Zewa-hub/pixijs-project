<!doctype html>
<html>
  <head>
    <script src="https://pixijs.download/release/pixi.js"></script>
  </head>
  <body>
    <script>
      let app = new PIXI.Application({ width: 640, height: 360 });
      document.body.appendChild(app.view);
      var sprite = PIXI.Sprite.from('./image/toupie.webp');
      var mechant = PIXI.Sprite.from("./image/lama_doggo.jpg")
      let background = PIXI.Sprite.from('./image/arena.jpg');
      
      var speed = 0
      var countHp = 0

      var elapsed = 0.0;
      var timer = 0;
      var go = false;

      app.stage.addChild(background);
      app.stage.addChild(sprite);
      app.stage.addChild(mechant);
      
      background.zIndex = 0
      background.height = 360;
      background.width = 640
     
      
      sprite.zIndex = 1
      sprite.anchor.x = 0.5;
      sprite.anchor.y = 0.5;
      sprite.x = 320;
      sprite.y = 180;
      sprite.width = 150;
      sprite.height = 150;
      sprite.y = 150 ;
      sprite.interactive = true;
      sprite.buttonMode = true;
      sprite.on('pointerdown', onClick);

      mechant.x = 650
      mechant.y = 0
      mechant.width = 100
      mechant.height = 100
      mechant.anchor.x = 0.5
      mechant.anchor.y = 0.5
      var mechant_speed = 10;
     
      area = Math.PI * sprite.width**2
      
      app.ticker.add((delta) => {
        elapsed += delta;
        
        mechant.angle += mechant_speed;
      if (elapsed > timer && speed >= 1){
        go =true
      }
       if (go)
       {
         deplacement()
       }
        sprite.angle += speed
      });

      function deplacement()
      {
        if(mechant.x > sprite.x + (sprite.width /2) || (mechant.x + mechant.width/2) < sprite.x || mechant.y > sprite.y + (sprite.height /2) || (mechant.y + mechant.height/2) < sprite.y )
        {
          if (mechant.x > sprite.x)
          {
            mechant.x -=  0.5;
          }
          if (mechant.y > sprite.y)
          {
            mechant.y -= 0.5;
          }
          if (mechant.y < sprite.y)
          {
            mechant.y += 0.5;
          }
          if (mechant.x < sprite.x)
          {
            mechant.x += 0.5;
          }
        }
        else
        {
          mechant.destroy()
        }
      }
      function onClick()
      {
        if (speed == 0 )
        {
            speed = 1
            timer = elapsed + 300
        }
        if(elapsed <= timer)
        {
          if (speed < 40)
          {
            speed=speed *1.2
          }
          countHp += 1
          console.log(countHp)
        }
      }
    </script>
  </body>
</html>
